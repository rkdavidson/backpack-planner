"use strict";angular.module("backpackPlannerApp",["ngGrid","nvd3ChartDirectives"]),angular.module("backpackPlannerApp").controller("MainCtrl",["$scope","$log","Foods",function(a,b,c){function d(a){var b=a.protein+a.carbs+a.fat,c=4*a.protein,d=4*a.carbs,e=9*a.fat;return{totalGrams:b||0,calsFromProtein:Math.round(c)||0,calsFromCarbs:Math.round(d)||0,calsFromFat:Math.round(e)||0,percentProtein:Math.round(a.protein/b*100)||0,percentCarbs:Math.round(a.carbs/b*100)||0,percentFat:Math.round(a.fat/b*100)||0,totalCals:c+d+e||0}}function e(a){return{macronutrientPieData:[{key:"P",y:a.protein},{key:"C",y:a.carbs},{key:"F",y:a.fat}],caloriesMassPieData:[{key:"Volume",y:a.calsPerCup},{key:"Weight",y:a.calsPerOunce}]}}a.$log=b,a.selectedFoodItems=[],a.selectedFoodRow=null,a.selectedFood=null,a.compareFoodRow=null,a.compareFood=null,a.mouseoverRow=function(b){a.compareFoodRow=b,a.compareFood=b.entity},a.foodGridConfig={data:"foodData",columnDefs:[{field:"category",displayName:"Category",width:0,visible:!1},{field:"description",displayName:"Description",cellClass:"descriptionCell",minWidth:170,width:"auto"},{field:"brand",displayName:"Brand",cellClass:"brandCell",minWidth:190,width:"auto"},{field:"size",displayName:"Size",cellClass:"sizeCell",minWidth:95,width:"auto"},{field:"ounces",displayName:"Weight",cellClass:"weightCell",cellTemplate:"views/grid/foodRowOunceCell.html"},{field:"water",displayName:"H2O",cellClass:"waterCell",maxWidth:50,width:"auto"},{field:"calories",displayName:"Cals",cellClass:"caloriesCell",minWidth:80,width:"auto"},{field:"protein",displayName:"Protein",cellClass:"proteinCell",cellTemplate:"views/grid/foodRowGramCell.html",minWidth:90,width:"auto"},{field:"analysis.percentProtein",displayName:"%",cellClass:"proteinCell percentCell",cellTemplate:"views/grid/foodRowPercentCell.html"},{field:"carbs",displayName:"Carbs",cellClass:"carbsCell",cellTemplate:"views/grid/foodRowGramCell.html",minWidth:90,width:"auto"},{field:"analysis.percentCarbs",displayName:"%",cellClass:"carbsCell percentCell",cellTemplate:"views/grid/foodRowPercentCell.html"},{field:"fat",displayName:"Fat",cellClass:"fatCell",cellTemplate:"views/grid/foodRowGramCell.html",minWidth:90,width:"auto"},{field:"analysis.percentFat",displayName:"%",cellClass:"fatCell percentCell",cellTemplate:"views/grid/foodRowPercentCell.html"},{field:"calsPerCup",displayName:"Cals/Cup",cellClass:"calsPerCupCell"},{field:"calsPerOunce",displayName:"Cals/Oz",cellClass:"calsPerOunceCell"}],rowTemplate:"views/grid/foodRow.html",rowHeight:30,showFilter:!0,enableHighlighting:!0,enableRowSelection:!0,multiSelect:!1,keepLastSelected:!0,enableColumnHeavyVirt:!0,sortInfo:{fields:["category","description"],directions:["asc"]},groups:["category"],groupsCollapsedByDefault:!1,afterSelectionChange:function(c){a.selectedFoodRow=c,a.selectedFood=c.entity,b.log(a.selectedFood)}},c.then(function(b){for(var c=b.length-1;c>=0;c--)b[c].analysis=d(b[c]),b[c].charts=e(b[c]);a.foodData=b});var f=["#FF4000","#AAD600","#33AAFF","#FF00FF"];a.macronutrientColorFunction=function(){return function(a,b){return f[b]}},a.xFunctionPie=function(){return function(a){return a.key}},a.yFunctionPie=function(){return function(a){return a.y}}}]),angular.module("backpackPlannerApp").factory("Foods",["$http","$q",function(a,b){var c="data/food-v1.json",d=b.defer();return a.get(c).then(function(a){d.resolve(a.data)}),d.promise}]),angular.module("backpackPlannerApp").directive("nutritionLabel",function(){return{restrict:"E",scope:{food:"=food"},templateUrl:"views/nutrition-label.html"}}),angular.module("backpackPlannerApp").directive("nutritionCharts",function(){return{restrict:"E",scope:{food:"=food"},templateUrl:"views/nutrition-charts.html"}});